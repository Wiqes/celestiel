import{C as u,Ka as o}from"./chunk-ZXNNLAB3.js";import{A as a,R as i,X as n,a as s,b as d,o as m,s as h,sa as l,tc as c}from"./chunk-QP7WRVZV.js";var p=class t{http=n(u);getUserData(){let e=localStorage.getItem("token");if(!e)return m(null);let f=JSON.parse(atob(e.split(".")[1])).username;return this.http.get(`${o.API_URL}/users/${f}`).pipe(a(b=>{throw console.error("Error fetching user data:",b.status),new Error("Failed to fetch user data")}))}getUserId(){return this.getUserData().pipe(h(e=>e?.id||""),a(()=>m("")))}getAnimals(){return this.http.get(`${o.API_URL}/animals`).pipe(a(e=>{throw console.error("Error fetching animals:",e.status),new Error("Failed to fetch animals")}))}getColors(){return this.http.get(`${o.API_URL}/colors`).pipe(a(e=>{throw console.error("Error fetching colors:",e.status),new Error("Failed to fetch colors")}))}getProfileByUserId(e){return this.http.get(`${o.API_URL}/profiles/${e}`).pipe(a(r=>{throw console.error("Error fetching profile by user ID:",r.status),new Error("Failed to fetch profile by user ID")}))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"})};var g="https://wiqes-images.s3.us-east-1.amazonaws.com/0dc7669a-a358-4410-8b3a-3f4510ef0cc6-avatar.png";var I=class t{user=l(null);animals=l([]);isDataLoading=l(!1);dataAccessService=n(p);profile=c(()=>this.user()?.profile);avatarUrl=c(()=>this.profile()?.avatarUrl||g);displayName=c(()=>this.profile()?.name||this.profile()?.email||"");addAnimalsDataToState(){this.animals()?.length||this.isDataLoading()||(this.isDataLoading.set(!0),this.dataAccessService.getAnimals().subscribe({next:e=>{this.animals.set(e)},error:()=>this.isDataLoading.set(!1),complete:()=>this.isDataLoading.set(!1)}))}addUserDataToState(){this.user()||this.isDataLoading()||(this.isDataLoading.set(!0),this.dataAccessService.getUserData().subscribe({next:e=>{this.user.set(e)},error:()=>this.isDataLoading.set(!1),complete:()=>this.isDataLoading.set(!1)}))}updateUserProfile(e){let r=this.user();if(r&&r.profile){let f=d(s({},r),{profile:s(s({},r.profile),e)});this.user.set(f)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"})};export{p as a,g as b,I as c};
