import{a as v,d as l}from"./chunk-N5HVNUXB.js";import{a as u,b as g}from"./chunk-PIVKBQQN.js";import{f as d}from"./chunk-K5BU6CYA.js";import{a as f}from"./chunk-ZEQNEQPC.js";import{C as m,Ka as h}from"./chunk-ZXNNLAB3.js";import{R as a,X as t,ga as c,sa as p}from"./chunk-QP7WRVZV.js";var s=class{http=t(m);messageService=t(g);isLoading=p(!1);makeAuthRequest(e,i,o,n,k=!0){this.isLoading.set(!0),this.http.post(`${h.API_URL}${e}`,i).subscribe({next:I=>{o(I),k&&this.isLoading.set(!1)},error:()=>{n(),this.isLoading.set(!1)}})}handleSuccess(e,i){e&&this.messageService.sendMessage(e),i&&i()}handleError(e){e&&this.messageService.sendMessage(e)}};var S=class r extends s{router=t(d);authTokenService=t(l);authTokenStateService=t(f);fingerprintService=t(v);getFingerprint(){return this.fingerprintService.getFingerprint()}request({email:e,password:i}){let o=this.getFingerprint();this.makeAuthRequest("/auth/login",{username:e,password:i,fingerprint:o},n=>this.onLoginSuccess(n),()=>this.handleError(u.LOGIN_FAILED),!1)}onLoginSuccess(e){e?.access_token?this.authTokenStateService.token.set(e.access_token):this.authTokenStateService.token.set(null),this.handleSuccess(null,()=>{setTimeout(()=>{this.router.navigate(["/home"]),this.isLoading.set(!1)},800)})}logout(){this.authTokenService.logout()}static \u0275fac=(()=>{let e;return function(o){return(e||(e=c(r)))(o||r)}})();static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a,S as b};
