import{a as h,b as u}from"./chunk-PZ7IBQ5D.js";import{a as g,c as l}from"./chunk-BWCUAARX.js";import{f as d}from"./chunk-GBD462O6.js";import{a as f}from"./chunk-AYKVXQHD.js";import{E as m,Ma as v}from"./chunk-XQ2JBN3L.js";import{S as a,Y as t,ha as c,ta as p}from"./chunk-KQHS7NYU.js";var s=class{http=t(m);messageService=t(u);isLoading=p(!1);makeAuthRequest(e,i,o,n,k=!0){this.isLoading.set(!0),this.http.post(`${v.API_URL}${e}`,i).subscribe({next:I=>{o(I),k&&this.isLoading.set(!1)},error:()=>{n(),this.isLoading.set(!1)}})}handleSuccess(e,i){e&&this.messageService.sendMessage(e),i&&i()}handleError(e){e&&this.messageService.sendMessage(e)}};var S=class r extends s{router=t(d);authTokenService=t(l);authTokenStateService=t(f);fingerprintService=t(g);getFingerprint(){return this.fingerprintService.getFingerprint()}request({email:e,password:i}){let o=this.getFingerprint();this.makeAuthRequest("/auth/login",{username:e,password:i,fingerprint:o},n=>this.onLoginSuccess(n),()=>this.handleError(h.LOGIN_FAILED),!1)}onLoginSuccess(e){e?.access_token?this.authTokenStateService.token.set(e.access_token):this.authTokenStateService.token.set(null),this.handleSuccess(null,()=>{setTimeout(()=>{this.router.navigate(["/home"]),this.isLoading.set(!1)},800)})}logout(){this.authTokenService.logout()}static \u0275fac=(()=>{let e;return function(o){return(e||(e=c(r)))(o||r)}})();static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a,S as b};
