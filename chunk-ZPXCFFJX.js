import{a as d,c as f,e as p}from"./chunk-KPEMCW7J.js";import{a as r}from"./chunk-67XSK42V.js";import{a as h}from"./chunk-WUSS4SHQ.js";import{R as a,X as n,ga as c,sa as m,tc as o}from"./chunk-QP7WRVZV.js";var u=class t extends d{isOtpRequested=m(!1);isPasswordConfirmationRequested=m(!1);request({email:e,password:s,otp:i}){this.makeAuthRequest("/auth/register",{username:e,password:s,otp:i},()=>this.onRegistrationSuccess(),()=>this.handleError(r.REGISTRATION_FAILED))}requestOTP(e){this.makeAuthRequest("/auth/request-otp",{username:e},()=>this.onOTPRequestSuccess(),()=>this.handleError(r.OTP_REQUEST_FAILED))}onRegistrationSuccess(){this.isOtpRequested.set(!1),this.handleSuccess(r.REGISTRATION_SUCCESS)}onOTPRequestSuccess(){this.handleSuccess(r.OTP_SENT,()=>{this.isOtpRequested.set(!0),this.isPasswordConfirmationRequested.set(!1)})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=c(t)))(i||t)}})();static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var S=class t extends d{request({email:e}){this.makeAuthRequest("/auth/request-password-reset",{username:e},()=>this.handleSuccess(r.FORGOT_PASSWORD_INFO),()=>this.handleError(r.FORGOT_PASSWORD_ERROR))}static \u0275fac=(()=>{let e;return function(i){return(e||(e=c(t)))(i||t)}})();static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var v=class t{loginService=n(p);authTokenStateService=n(h);registrationService=n(u);passwordResetService=n(S);isLoadingLogin=o(()=>this.loginService.isLoading());isLoadingRegistration=o(()=>this.registrationService.isLoading());isOtpRequested=o(()=>this.registrationService.isOtpRequested());isPasswordConfirmationRequested=o(()=>this.registrationService.isPasswordConfirmationRequested());isResetPasswordRequested=o(()=>this.passwordResetService.isLoading());token=o(()=>this.authTokenStateService.token());hasRole(e){return this.token()?f(this.token()||"").roles?.includes(e):!1}login(e,s){this.loginService.request({email:e,password:s})}register({email:e,password:s,otp:i}){this.registrationService.request({email:e,password:s,otp:i})}requestOTP(e){this.registrationService.requestOTP(e)}reset(){this.registrationService.isOtpRequested.set(!1),this.registrationService.isPasswordConfirmationRequested.set(!1)}requestPasswordConfirmation(){this.registrationService.isPasswordConfirmationRequested.set(!0)}sendPasswordResetRequest(e){this.passwordResetService.request({email:e})}static \u0275fac=function(s){return new(s||t)};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};export{v as a};
