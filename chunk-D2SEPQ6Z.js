import{C as h,Ka as a}from"./chunk-3E3OHC6J.js";import{B as o,T as i,Z as n,a as s,b as m,o as d,ua as l,xc as c,y as u}from"./chunk-FGD53Q7F.js";var p=class t{http=n(h);getUserData(){let r=localStorage.getItem("token");if(!r)return d(null);let f=JSON.parse(atob(r.split(".")[1])).username;return this.http.get(`${a.API_URL}/users/${f}`).pipe(o(A=>{throw console.error("Error fetching user data:",A.status),new Error("Failed to fetch user data")}))}getAnimals(){return this.http.get(`${a.API_URL}/animals`).pipe(o(r=>{throw console.error("Error fetching animals:",r.status),new Error("Failed to fetch animals")}))}getColors(){return this.http.get(`${a.API_URL}/colors`).pipe(o(r=>{throw console.error("Error fetching colors:",r.status),new Error("Failed to fetch colors")}))}getProfileByUserId(r){return this.http.get(`${a.API_URL}/profiles/${r}`).pipe(o(e=>{throw console.error("Error fetching profile by user ID:",e.status),new Error("Failed to fetch profile by user ID")}))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"})};var I="https://wiqes-images.s3.us-east-1.amazonaws.com/0dc7669a-a358-4410-8b3a-3f4510ef0cc6-avatar.png";var g=class t{user=l(null);animals=l([]);isDataLoading=l(!1);dataAccessService=n(p);profile=c(()=>this.user()?.profile);avatarUrl=c(()=>this.profile()?.avatarUrl||I);displayName=c(()=>this.profile()?.name||this.profile()?.email||"");addBackendDataToState(){this.user()||this.isDataLoading()||(this.isDataLoading.set(!0),u({user:this.dataAccessService.getUserData(),animals:this.dataAccessService.getAnimals()}).subscribe({next:({user:r,animals:e})=>{this.user.set(r),this.animals.set(e)},error:()=>this.isDataLoading.set(!1),complete:()=>this.isDataLoading.set(!1)}))}updateUserProfile(r){let e=this.user();if(e&&e.profile){let f=m(s({},e),{profile:s(s({},e.profile),r)});this.user.set(f)}}static \u0275fac=function(e){return new(e||t)};static \u0275prov=i({token:t,factory:t.\u0275fac,providedIn:"root"})};export{p as a,I as b,g as c};
