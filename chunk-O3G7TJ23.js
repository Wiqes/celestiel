import{a as v,d as l}from"./chunk-OI26NONV.js";import{a as u,b as g}from"./chunk-3I4IKEUX.js";import{f as d}from"./chunk-7QJGNWLS.js";import{a as f}from"./chunk-NKJI4WKF.js";import{a as h}from"./chunk-WDKYZAS4.js";import{D as m}from"./chunk-PEZBE47A.js";import{T as a,Z as t,ia as c,ua as p}from"./chunk-M6NNEASU.js";var s=class{http=t(m);messageService=t(g);isLoading=p(!1);makeAuthRequest(e,i,o,n,k=!0){this.isLoading.set(!0),this.http.post(`${h.API_URL}${e}`,i).subscribe({next:I=>{o(I),k&&this.isLoading.set(!1)},error:()=>{n(),this.isLoading.set(!1)}})}handleSuccess(e,i){e&&this.messageService.sendMessage(e),i&&i()}handleError(e){e&&this.messageService.sendMessage(e)}};var S=class r extends s{router=t(d);authTokenService=t(l);authTokenStateService=t(f);fingerprintService=t(v);getFingerprint(){return this.fingerprintService.getFingerprint()}request({email:e,password:i}){let o=this.getFingerprint();this.makeAuthRequest("/auth/login",{username:e,password:i,fingerprint:o},n=>this.onLoginSuccess(n),()=>this.handleError(u.LOGIN_FAILED),!1)}onLoginSuccess(e){e?.access_token?this.authTokenStateService.token.set(e.access_token):this.authTokenStateService.token.set(null),this.handleSuccess(null,()=>{setTimeout(()=>{this.router.navigate(["/home"]),this.isLoading.set(!1)},800)})}logout(){this.authTokenService.logout()}static \u0275fac=(()=>{let e;return function(o){return(e||(e=c(r)))(o||r)}})();static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a,S as b};
